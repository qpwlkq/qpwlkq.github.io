<!DOCTYPE html>
<html lang="cn">
<head>
    <meta charset="UTF-8">
<meta name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

    <meta name="author" content="Qin Peng">





<title>模板1_数论 | Hexo</title>



    <link rel="icon" href="/favicon.ico">




    <!-- stylesheets list from _config.yml -->
    
    <link rel="stylesheet" href="/css/style.css">
    



    <!-- scripts list from _config.yml -->
    
    <script src="/js/script.js"></script>
    
    <script src="/js/tocbot.min.js"></script>
    



    
    
        <!-- MathJax配置，可通过单美元符号书写行内公式等 -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
    "HTML-CSS": {
        preferredFont: "TeX",
        availableFonts: ["STIX","TeX"],
        linebreaks: { automatic:true },
        EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50)
    },
    tex2jax: {
        inlineMath: [ ["$", "$"], ["\\(","\\)"] ],
        processEscapes: true,
        ignoreClass: "tex2jax_ignore|dno",
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    TeX: {
        equationNumbers: { autoNumber: "AMS" },
        noUndefined: { attributes: { mathcolor: "red", mathbackground: "#FFEEEE", mathsize: "90%" } },
        Macros: { href: "{}" }
    },
    messageStyle: "none"
    });
</script>
<!-- 给MathJax元素添加has-jax class -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>
<!-- 通过连接CDN加载MathJax的js代码 -->
<script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML">
</script>


    


<meta name="generator" content="Hexo 4.2.0"></head>
<body>
    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo"><a href="/">QPWLKQ&#39;s Blog</a></div>
            <div class="menu navbar-right">
                
                    <a class="menu-item" href="/archives">Archives</a>
                
                    <a class="menu-item" href="/category">Categories</a>
                
                    <a class="menu-item" href="/tag">Tags</a>
                
                    <a class="menu-item" href="/about">About</a>
                
                <input id="switch_default" type="checkbox" class="switch_default">
                <label for="switch_default" class="toggleBtn"></label>
            </div>
        </div>
    </nav>

    
    <nav class="navbar-mobile" id="nav-mobile">
        <div class="container">
            <div class="navbar-header">
                <div>
                    <a href="/">QPWLKQ&#39;s Blog</a><a id="mobile-toggle-theme">·&nbsp;Light</a>
                </div>
                <div class="menu-toggle" onclick="mobileBtn()">&#9776; Menu</div>
            </div>
            <div class="menu" id="mobile-menu">
                
                    <a class="menu-item" href="/archives">Archives</a>
                
                    <a class="menu-item" href="/category">Categories</a>
                
                    <a class="menu-item" href="/tag">Tags</a>
                
                    <a class="menu-item" href="/about">About</a>
                
            </div>
        </div>
    </nav>

</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementsByClassName("menu-toggle")[0];
        var mobileMenu = document.getElementById("mobile-menu");
        if(toggleMenu.classList.contains("active")){
           toggleMenu.classList.remove("active")
            mobileMenu.classList.remove("active")
        }else{
            toggleMenu.classList.add("active")
            mobileMenu.classList.add("active")
        }
    }
</script>
        <div class="main">
            <div class="container">
    
    
        <div class="post-toc">
    <div class="tocbot-list">
    </div>
    <div class="tocbot-list-menu">
        <a class="tocbot-toc-expand" onclick="expand_toc()">Expand all</a>
        <a onclick="go_top()">Back to top</a>
        <a onclick="go_bottom()">Go to bottom</a>
    </div>
</div>

<script>
    document.ready(
        function () {
            tocbot.init({
                tocSelector: '.tocbot-list',
                contentSelector: '.post-content',
                headingSelector: 'h1, h2, h3, h4, h5',
                collapseDepth: 1,
                orderedList: false,
                scrollSmooth: true,
            })
        }
    )

    function expand_toc() {
        var b = document.querySelector(".tocbot-toc-expand");
        tocbot.init({
            tocSelector: '.tocbot-list',
            contentSelector: '.post-content',
            headingSelector: 'h1, h2, h3, h4, h5',
            collapseDepth: 6,
            orderedList: false,
            scrollSmooth: true,
        });
        b.setAttribute("onclick", "collapse_toc()");
        b.innerHTML = "Collapse all"
    }

    function collapse_toc() {
        var b = document.querySelector(".tocbot-toc-expand");
        tocbot.init({
            tocSelector: '.tocbot-list',
            contentSelector: '.post-content',
            headingSelector: 'h1, h2, h3, h4, h5',
            collapseDepth: 1,
            orderedList: false,
            scrollSmooth: true,
        });
        b.setAttribute("onclick", "expand_toc()");
        b.innerHTML = "Expand all"
    }

    function go_top() {
        window.scrollTo(0, 0);
    }

    function go_bottom() {
        window.scrollTo(0, document.body.scrollHeight);
    }

</script>
    

    
    <article class="post-wrap">
        <header class="post-header">
            <h1 class="post-title">模板1_数论</h1>
            
                <div class="post-meta">
                    
                        Author: <a itemprop="author" rel="author" href="/">Qin Peng</a>
                    

                    
                        <span class="post-time">
                        Date: <a href="#">October 13, 2020&nbsp;&nbsp;20:24:34</a>
                        </span>
                    
                    
                        <span class="post-category">
                    Category:
                            
                                <a href="/categories/%E6%A8%A1%E6%9D%BF/">模板</a>
                            
                        </span>
                    
                </div>
            
        </header>

        <div class="post-content">
            <p>[TOC]</p>
<h1 id="数论模板"><a href="#数论模板" class="headerlink" title="数论模板"></a>数论模板</h1><h2 id="一-线性筛"><a href="#一-线性筛" class="headerlink" title="一, 线性筛"></a>一, 线性筛</h2><p>所有数组定义在外面, 自动置为全0即可</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    cnt = <span class="number">0</span>; <span class="comment">//统计素数个数</span></span><br><span class="line">    is_prime[<span class="number">1</span>] = <span class="number">1</span>; <span class="comment">//0代表是素数, 1不是素数</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= maxn; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!is_prime[i]) &#123;</span><br><span class="line">            prime[++cnt] = i; <span class="comment">//i是素数, prime从下标[1]开始有记录</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= cnt; j++) &#123; <span class="comment">// 1 到 cnt !</span></span><br><span class="line">            <span class="keyword">if</span> (prime[j] * i &gt;= maxn)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            is_prime[i * prime[j]] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (i % prime[j] == <span class="number">0</span>)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="1-分解质因数"><a href="#1-分解质因数" class="headerlink" title="1.分解质因数"></a>1.分解质因数</h3><p>通过素数筛法打表, 然后只能通过优化暴力, <strong>最快了</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">get_primefactors</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= tot &amp;&amp; pri[i] * pri[i] &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="keyword">if</span> (n % pri[i] == <span class="number">0</span>) &#123;</span><br><span class="line">            fac[++sum] = pri[i];</span><br><span class="line">            <span class="keyword">while</span> (n % pri[i] == <span class="number">0</span>) &#123;</span><br><span class="line">                n /= pri[i];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (n &gt; <span class="number">1</span>) &#123;</span><br><span class="line">        fac[++sum] = n;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-区间线性筛"><a href="#2-区间线性筛" class="headerlink" title="2.区间线性筛"></a>2.区间线性筛</h3><p>a, b可以很大, 但是b - a 的结果可以接受</p>
<p>模板 : 输出a 到 b之间的素数个数</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">100005</span>;</span><br><span class="line"><span class="keyword">bool</span> is[MAXN];</span><br><span class="line"><span class="keyword">int</span> pri[MAXN / <span class="number">10</span>];</span><br><span class="line"><span class="keyword">int</span> cnt;</span><br><span class="line"><span class="keyword">bool</span> ans[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(is, <span class="literal">true</span>, <span class="keyword">sizeof</span>(is));</span><br><span class="line">    is[<span class="number">0</span>] = is[<span class="number">1</span>] = <span class="literal">false</span>;</span><br><span class="line">    cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; MAXN; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (is[i]) &#123;</span><br><span class="line">            pri[++cnt] = i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt; cnt &amp;&amp; pri[j] * i &lt; MAXN; j++) &#123;</span><br><span class="line">            is[pri[j] * i] = <span class="literal">false</span>;</span><br><span class="line">            <span class="keyword">if</span> (i % pri[j] == <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">solve</span><span class="params">(ll a, ll b)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(ans, <span class="literal">true</span>, <span class="keyword">sizeof</span>(ans));</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= cnt &amp;&amp; <span class="number">1l</span>l * pri[i] * pri[i] &lt;= b; i++) &#123;</span><br><span class="line">        ll s = (a + pri[i] - <span class="number">1</span>) / pri[i];</span><br><span class="line">        <span class="keyword">if</span> (s &lt; <span class="number">2</span>) &#123;</span><br><span class="line">            s = <span class="number">2</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        s *= pri[i];</span><br><span class="line">        <span class="keyword">for</span> (; s &lt;= b; s += pri[i]) &#123;</span><br><span class="line">            ans[s - a] = <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= b - a; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (ans[i]) &#123;</span><br><span class="line">            res++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (a == <span class="number">1</span>) &#123;</span><br><span class="line">        res--;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    init();</span><br><span class="line">    <span class="keyword">int</span> a, b;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; a &gt;&gt; b;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; solve(a, b);</span><br><span class="line">    <span class="comment">// 2 , 3 , 5,  7</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-求各种积性函数"><a href="#3-求各种积性函数" class="headerlink" title="3.求各种积性函数"></a>3.求各种积性函数</h3><p>YC究极版!</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e7</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">bool</span> is[N]; <span class="comment">//筛数组</span></span><br><span class="line"><span class="keyword">int</span> pri[N]; <span class="comment">//素数数组</span></span><br><span class="line"><span class="keyword">int</span> phi[N]; <span class="comment">//欧拉函数数组 !</span></span><br><span class="line"><span class="keyword">int</span> mu[N]; <span class="comment">//莫⽐乌斯函数数组</span></span><br><span class="line"><span class="keyword">int</span> e[N]; <span class="comment">//n的最⼩素因⼦在唯⼀分解中的幂次</span></span><br><span class="line"><span class="keyword">int</span> d[N]; <span class="comment">//因数个数 !</span></span><br><span class="line"><span class="keyword">int</span> fac[N]; <span class="comment">//i的最⼩的幂次⼤于1的质因数的幂</span></span><br><span class="line"><span class="keyword">int</span> tot; <span class="comment">//素数个数</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(is, <span class="literal">true</span>, <span class="keyword">sizeof</span>(is));</span><br><span class="line">    tot = <span class="number">0</span>;</span><br><span class="line">    is[<span class="number">0</span>] = is[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    mu[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    phi[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    fac[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    e[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    d[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; N; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (is[i]) &#123;</span><br><span class="line">            pri[++tot] = i;</span><br><span class="line">            phi[i] = i - <span class="number">1</span>;</span><br><span class="line">            mu[i] = <span class="number">-1</span>;</span><br><span class="line">            e[i] = <span class="number">1</span>;</span><br><span class="line">            d[i] = <span class="number">2</span>;</span><br><span class="line">            fac[i] = i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= tot &amp;&amp; pri[j] * i &lt; N; j++) &#123;</span><br><span class="line">            is[pri[j] * i] = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">if</span> (i % pri[j] == <span class="number">0</span>) &#123;</span><br><span class="line">                phi[i * pri[j]] = phi[i] * pri[j];</span><br><span class="line">                mu[i * pri[j]] = <span class="number">0</span>;</span><br><span class="line">                d[pri[j] * i] = d[i] / (e[i] + <span class="number">1</span>) * (e[i] + <span class="number">2</span>);</span><br><span class="line">                e[pri[j] * i] = e[i] + <span class="number">1</span>;</span><br><span class="line">                fac[i * pri[j]] = fac[i] * pri[j];</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                mu[i * pri[j]] = -mu[i];</span><br><span class="line">                phi[i * pri[j]] = phi[i] * (pri[j] - <span class="number">1</span>);</span><br><span class="line">                e[pri[j] * i] = <span class="number">1</span>;</span><br><span class="line">                d[pri[j] * i] = d[i] * d[pri[j]];</span><br><span class="line">                fac[i * pri[j]] = pri[j];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    init();</span><br><span class="line">    <span class="keyword">int</span> a, b;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; a &gt;&gt; b;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; d[a] &lt;&lt; <span class="string">' '</span> &lt;&lt; d[b];</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="二-Min-25筛"><a href="#二-Min-25筛" class="headerlink" title="二, Min_25筛"></a>二, Min_25筛</h2><h4 id="求十亿-1e9-内所有质数的和"><a href="#求十亿-1e9-内所有质数的和" class="headerlink" title="求十亿(1e9)内所有质数的和"></a>求十亿(1e9)内所有质数的和</h4><p>$O(n ^{3/4})$</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 求比n小的所有素数的和</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1000010</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> Min25 &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> prime[N], id1[N], id2[N], flag[N], ncnt, m;</span><br><span class="line"></span><br><span class="line">    LL g[N], sum[N], a[N], T, n;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">ID</span><span class="params">(LL x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> x &lt;= T ? id1[x] : id2[n / x];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">inline</span> LL <span class="title">calc</span><span class="params">(LL x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> x * (x + <span class="number">1</span>) / <span class="number">2</span> - <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">inline</span> LL <span class="title">f</span><span class="params">(LL x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        T = <span class="built_in">sqrt</span>(n + <span class="number">0.5</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= T; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!flag[i]) prime[++ncnt] = i, sum[ncnt] = sum[ncnt - <span class="number">1</span>] + i;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= ncnt &amp;&amp; i * prime[j] &lt;= T; j++) &#123;</span><br><span class="line">                flag[i * prime[j]] = <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">if</span> (i % prime[j] == <span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (LL l = <span class="number">1</span>; l &lt;= n; l = n / (n / l) + <span class="number">1</span>) &#123;</span><br><span class="line">            a[++m] = n / l;</span><br><span class="line">            <span class="keyword">if</span> (a[m] &lt;= T) id1[a[m]] = m; <span class="keyword">else</span> id2[n / a[m]] = m;</span><br><span class="line">            g[m] = calc(a[m]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= ncnt; i++)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= m &amp;&amp; (LL)prime[i] * prime[i] &lt;= a[j]; j++)</span><br><span class="line">                g[j] = g[j] - (LL)prime[i] * (g[ID(a[j] / prime[i])] - sum[i - <span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">inline</span> LL <span class="title">solve</span><span class="params">(LL x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (x &lt;= <span class="number">1</span>) <span class="keyword">return</span> x;</span><br><span class="line">        <span class="keyword">return</span> n = x, init(), g[ID(n)];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    LL n; <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;n);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, Min25::solve(n));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="求积性函数的前缀和"><a href="#求积性函数的前缀和" class="headerlink" title="求积性函数的前缀和"></a>求积性函数的前缀和</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br></pre></td><td class="code"><pre><span class="line">#include&lt;bits&#x2F;stdc++.h&gt;</span><br><span class="line">using namespace std;</span><br><span class="line">#define ll long long</span><br><span class="line">const int maxn &#x3D; 2000000+100;</span><br><span class="line"></span><br><span class="line">&#x2F;******************************</span><br><span class="line">f()函数中(31-37行) 填函数在质数幂次处的表达式</span><br><span class="line">pow_sum()函数中(38-43行) 填幂和函数（如果需要更高次的话可以在这里添加）</span><br><span class="line">202-205行按要求填写</span><br><span class="line">f_p[][0&#x2F;1&#x2F;2&#x2F;3&#x2F;...]分别代表质数个数&#x2F;质数和&#x2F;质数平方和&#x2F;质数三次方和&#x2F;...根据自己需要添加</span><br><span class="line">例：如果该函数在质数处表达式为f(p) &#x3D; p^2+3*p+1</span><br><span class="line">则表明需要质数个数&#x2F;质数和&#x2F;质数平方和</span><br><span class="line">即f_p[][0],f_p[][1],f_p[][2]</span><br><span class="line">******************************&#x2F;</span><br><span class="line"></span><br><span class="line">ll poww(ll a,ll b)&#123;</span><br><span class="line">    ll res &#x3D; 1;</span><br><span class="line">    ll base &#x3D; a;</span><br><span class="line">    while(b)&#123;</span><br><span class="line">        if(b&amp;1)&#123;</span><br><span class="line">            res *&#x3D; base;</span><br><span class="line">            &#x2F;&#x2F;res %&#x3D; mod;</span><br><span class="line">        &#125;</span><br><span class="line">        base *&#x3D; base;</span><br><span class="line">        &#x2F;&#x2F;base %&#x3D; mod;</span><br><span class="line">        b&gt;&gt;&#x3D;1;</span><br><span class="line">    &#125;</span><br><span class="line">    return res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">inline ll f(ll p,int e)&#123;</span><br><span class="line">    if(p&#x3D;&#x3D;1||e&#x3D;&#x3D;0) return 1;</span><br><span class="line">    &#x2F;&#x2F;&#x2F;return f(p^e)</span><br><span class="line">    ll res &#x3D; poww(p,e);</span><br><span class="line">    return res*res+3*res+1;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">ll pow_sum(ll n,int k)&#123;</span><br><span class="line">    &#x2F;&#x2F;&#x2F;return sum(i^k),i from 1 to n.</span><br><span class="line">    if(k&#x3D;&#x3D;0) return n;</span><br><span class="line">    if(k&#x3D;&#x3D;1) return n*(n+1)&#x2F;2;</span><br><span class="line">    if(k&#x3D;&#x3D;2) return n*(n+1)*(2*n+1)&#x2F;6;</span><br><span class="line">&#125;</span><br><span class="line">ll f_p[maxn][3];&#x2F;&#x2F;&#x2F;F_prime(id(n&#x2F;i))</span><br><span class="line">ll n;</span><br><span class="line">int n_2; &#x2F;&#x2F;&#x2F;(int)sqrt(n)</span><br><span class="line">int n_3; &#x2F;&#x2F;&#x2F;(int)pow(n,1.0&#x2F;3.0)</span><br><span class="line">int n_6; &#x2F;&#x2F;&#x2F;(int)pow(n,1.0&#x2F;6.0)</span><br><span class="line">ll val_id[maxn]; &#x2F;&#x2F;&#x2F;give the id, return the id-th number like &#39;n&#x2F;i&#39; ,(val_id[1] &#x3D; 1)</span><br><span class="line">int val_id_num; &#x2F;&#x2F;&#x2F;how many numbers like &#39;n&#x2F;i&#39;</span><br><span class="line">int val_id_num_3; &#x2F;&#x2F;&#x2F;how many numbers like &#39;n&#x2F;i&#39; below n&#x2F;n_3;</span><br><span class="line">int p[200000+100];</span><br><span class="line">bool isp[maxn];</span><br><span class="line">int p_sz_2; &#x2F;&#x2F;&#x2F;pi(n_2)</span><br><span class="line">int p_sz_3; &#x2F;&#x2F;&#x2F;pi(n_3)</span><br><span class="line">int p_sz_6; &#x2F;&#x2F;&#x2F;pi(n_6)</span><br><span class="line">void init()&#123;</span><br><span class="line">    n_2 &#x3D; (int)sqrt(n);</span><br><span class="line">    n_3 &#x3D; (int)pow(n,1.0&#x2F;3.0);</span><br><span class="line">    n_6 &#x3D; (int)pow(n,1.0&#x2F;6.0);</span><br><span class="line">    val_id_num &#x3D; 0;</span><br><span class="line">    for(ll i&#x3D;1;i&lt;&#x3D;n;)&#123;</span><br><span class="line">        val_id[++val_id_num] &#x3D; i;</span><br><span class="line">        if(i&#x3D;&#x3D;n) break;</span><br><span class="line">        i &#x3D; n&#x2F;(n&#x2F;(i+1));</span><br><span class="line">    &#125;</span><br><span class="line">    memset(isp,1,sizeof isp);</span><br><span class="line">    isp[1] &#x3D; 0;</span><br><span class="line">    for(int i&#x3D;2;i&lt;&#x3D;n_2;i++)&#123;</span><br><span class="line">        if(isp[i])&#123;</span><br><span class="line">            p[++p_sz_2] &#x3D; i;</span><br><span class="line">            if(i&lt;&#x3D;n_3) p_sz_3++;</span><br><span class="line">            if(i&lt;&#x3D;n_6) p_sz_6++;</span><br><span class="line">        &#125;</span><br><span class="line">        for(int j&#x3D;1;j&lt;&#x3D;p_sz_2&amp;&amp;p[j]*i&lt;&#x3D;n_2;j++)&#123;</span><br><span class="line">            isp[i*p[j]] &#x3D; 0;</span><br><span class="line">            if(i%p[j]&#x3D;&#x3D;0) break;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">inline int get_id(ll k)&#123; &#x2F;&#x2F;&#x2F;give a number like &#39;n&#x2F;i&#39;, return the id of it</span><br><span class="line">    if(k&gt;n_2) return val_id_num-n&#x2F;k+1;</span><br><span class="line">    else return k;</span><br><span class="line">&#125;</span><br><span class="line">ll c[maxn];</span><br><span class="line">int lowbit(int n)&#123;return n &amp; (-n);&#125;</span><br><span class="line">void add(int x,ll d)&#123;</span><br><span class="line">    while(x&lt;maxn)&#123;</span><br><span class="line">        c[x]+&#x3D;d;</span><br><span class="line">        x+&#x3D;lowbit(x);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">ll sum(int x)&#123;</span><br><span class="line">    ll ans&#x3D;0;</span><br><span class="line">    while(x)&#123;</span><br><span class="line">        ans+&#x3D;c[x];</span><br><span class="line">        x-&#x3D;lowbit(x);</span><br><span class="line">    &#125;</span><br><span class="line">    return ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">struct node&#123;</span><br><span class="line">    int k_max;</span><br><span class="line">    ll val;</span><br><span class="line">    ll f_val;</span><br><span class="line">&#125;;</span><br><span class="line">void update_bfs(int k,int type)&#123;</span><br><span class="line">    queue&lt;node&gt; q;</span><br><span class="line">    while(!q.empty()) q.pop();</span><br><span class="line">    int e &#x3D; 1;</span><br><span class="line">    for(ll i&#x3D;p[k];i&lt;n&#x2F;n_3;i*&#x3D;p[k])&#123;</span><br><span class="line">        node st;</span><br><span class="line">        st.k_max &#x3D; k;</span><br><span class="line">        st.val &#x3D; i;</span><br><span class="line">        if(type&#x3D;&#x3D;-1)st.f_val &#x3D; f(p[k],e);</span><br><span class="line">        else st.f_val &#x3D; poww(i,type);</span><br><span class="line">        q.push(st);</span><br><span class="line">        e++;</span><br><span class="line">    &#125;</span><br><span class="line">    while(!q.empty())&#123;</span><br><span class="line">        node hd &#x3D; q.front();</span><br><span class="line">        q.pop();</span><br><span class="line">        if((hd.val!&#x3D;p[hd.k_max]&amp;&amp;type&gt;&#x3D;0)||type&#x3D;&#x3D;-1) &#123;&#x2F;&#x2F;if(type&#x3D;&#x3D;-1)cout &lt;&lt; &quot;****&quot; &lt;&lt; hd.val &lt;&lt; &quot;****&quot; &lt;&lt; hd.f_val &lt;&lt; endl;</span><br><span class="line">            ll w &#x3D; n&#x2F;hd.val;</span><br><span class="line">            w &#x3D; n&#x2F;w;&#x2F;&#x2F;cout &lt;&lt; hd.val &lt;&lt; &quot;[&quot; &lt;&lt; w&lt;&lt;&quot; , &quot; &lt;&lt; val_id[val_id_num] &lt;&lt; &quot;]&quot; &lt;&lt; endl;</span><br><span class="line">            if(type&#x3D;&#x3D;-1)&#123;</span><br><span class="line">                add(get_id(w),hd.f_val);</span><br><span class="line">                add(val_id_num+1,-1ll*hd.f_val);</span><br><span class="line">            &#125;</span><br><span class="line">            else&#123;</span><br><span class="line">                add(get_id(w),-1ll*hd.f_val);</span><br><span class="line">                add(val_id_num+1,hd.f_val);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        for(int i&#x3D;hd.k_max+1;hd.val*p[i]&lt;n&#x2F;n_3&amp;&amp;i&lt;&#x3D;p_sz_2;i++)&#123;</span><br><span class="line">            ll res &#x3D; p[i];</span><br><span class="line">            for(int e&#x3D;1;;e++)&#123;</span><br><span class="line">                if(hd.val*res&lt;n&#x2F;n_3)&#123;</span><br><span class="line">                    node nxt;</span><br><span class="line">                    nxt.k_max &#x3D; i;</span><br><span class="line">                    nxt.val &#x3D; hd.val*res;</span><br><span class="line">                    if(type&#x3D;&#x3D;-1) nxt.f_val &#x3D; hd.f_val*f(p[i],e);</span><br><span class="line">                    else nxt.f_val &#x3D; hd.f_val*poww(res,type);</span><br><span class="line">                    q.push(nxt);</span><br><span class="line">                &#125;</span><br><span class="line">                else break;</span><br><span class="line">                res *&#x3D; p[i];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">void get_f_p(ll n,int times)&#123;</span><br><span class="line">    for(int i&#x3D;1;i&lt;&#x3D;val_id_num;i++)&#123;</span><br><span class="line">        for(int j&#x3D;0;j&lt;&#x3D;times;j++)&#123;</span><br><span class="line">            f_p[i][j] &#x3D; pow_sum(val_id[i],j)-1;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    int now;</span><br><span class="line">    &#x2F;&#x2F;for(now&#x3D;1;now&lt;&#x3D;p_sz_2;now++)&#123;</span><br><span class="line">    for(now&#x3D;1;p[now]&lt;&#x3D;n_6;now++)&#123;</span><br><span class="line">        for(int j&#x3D;val_id_num;j&gt;&#x3D;1;j--)&#123;</span><br><span class="line">            ll w &#x3D; val_id[j]&#x2F;p[now];</span><br><span class="line">            if(w&lt;p[now]) break;</span><br><span class="line">            ll val&#x3D;1;</span><br><span class="line">            for(int k &#x3D; 0;k&lt;&#x3D;times;k++)&#123;</span><br><span class="line">                f_p[j][k] &#x3D; f_p[j][k] - val*(f_p[get_id(w)][k]-f_p[p[now-1]][k]);</span><br><span class="line">                val *&#x3D; p[now];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    int nnow &#x3D; now;</span><br><span class="line">    int val &#x3D; 1;</span><br><span class="line">    for(int tt &#x3D; 0;tt&lt;&#x3D;times;tt++)&#123;</span><br><span class="line">        now &#x3D; nnow;</span><br><span class="line">        memset(c,0,sizeof c);</span><br><span class="line">        add(1,f_p[1][tt]);</span><br><span class="line">        for(int i&#x3D;2;val_id[i]&lt;n&#x2F;n_3;i++)&#123;</span><br><span class="line">            add(i,f_p[i][tt] - f_p[i-1][tt]);</span><br><span class="line">        &#125;</span><br><span class="line">        for(;p[now]&lt;&#x3D;n_3;now++)&#123;</span><br><span class="line">            for(int j&#x3D;val_id_num;j&gt;&#x3D;1;j--)&#123;</span><br><span class="line">                ll w &#x3D; val_id[j]&#x2F;p[now];</span><br><span class="line">                if(val_id[j]&lt;n&#x2F;n_3) break;</span><br><span class="line">                if(w&lt;p[now]) break;</span><br><span class="line">                if(w&lt;n&#x2F;n_3) f_p[j][tt] &#x3D; f_p[j][tt] - (sum(get_id(w)) - sum(p[now-1]))*poww(p[now],tt);</span><br><span class="line">                else f_p[j][tt] &#x3D; f_p[j][tt] - (f_p[get_id(w)][tt]-sum(p[now-1]))*poww(p[now],tt);</span><br><span class="line">            &#125;</span><br><span class="line">            update_bfs(now,tt);</span><br><span class="line">        &#125;</span><br><span class="line">        for(int i&#x3D;1;i&lt;&#x3D;val_id_num&amp;&amp;val_id[i]&lt;n&#x2F;n_3;i++)</span><br><span class="line">            f_p[i][tt] &#x3D; sum(i);</span><br><span class="line">        for(;now&lt;&#x3D;p_sz_2;now++)&#123;</span><br><span class="line">            for(int j&#x3D;val_id_num;j&gt;&#x3D;1;j--)&#123;</span><br><span class="line">                ll w &#x3D; val_id[j]&#x2F;p[now];</span><br><span class="line">                if(val_id[j]&lt;n&#x2F;n_3) break;</span><br><span class="line">                if(w&lt;p[now]) break;</span><br><span class="line">                f_p[j][tt] -&#x3D; (f_p[get_id(w)][tt]-f_p[p[now-1]][tt])*poww(p[now],tt);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    for(int i&#x3D;1;i&lt;&#x3D;val_id_num;i++)&#123;</span><br><span class="line">        &#x2F;&#x2F;&#x2F;if f(p) &#x3D; p^2+3p+1,then write:f_p[i][0] &#x3D; f_p[i][2] + 3*f_p[i][1] + f_p[i][0];</span><br><span class="line">        f_p[i][0] &#x3D; f_p[i][2] + 3*f_p[i][1] + f_p[i][0];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">ll F[2000000+100];</span><br><span class="line">void get_f_3(ll n)&#123; &#x2F;&#x2F;&#x2F;V(F_&#123;pi(n^(1&#x2F;3))+1&#125;,n)</span><br><span class="line">    ll q &#x3D; p[p_sz_3+1];</span><br><span class="line">    for(int now&#x3D;1;now&lt;&#x3D;val_id_num;now++)&#123;</span><br><span class="line">        if(val_id[now]&lt;q)&#123;</span><br><span class="line">            F[now] &#x3D; 1;</span><br><span class="line">        &#125;</span><br><span class="line">        else if(val_id[now]&lt;q*q)&#123;</span><br><span class="line">            F[now] &#x3D; 1+(f_p[now][0]-f_p[q-1][0]);</span><br><span class="line">        &#125;</span><br><span class="line">        else&#123;</span><br><span class="line">            F[now] &#x3D; 1+(f_p[now][0]-f_p[q-1][0]);</span><br><span class="line">            for(int pp&#x3D;p_sz_3+1;p[pp]&lt;&#x3D;(int)(sqrt(val_id[now]))&amp;&amp;pp&lt;&#x3D;p_sz_2;pp++)&#123;</span><br><span class="line">                F[now] +&#x3D; f(p[pp],2) + (f(p[pp],1))*(f_p[get_id(val_id[now]&#x2F;p[pp])][0]-f_p[get_id(p[pp])][0]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">void get_f_6(ll n)&#123; &#x2F;&#x2F;&#x2F;V(F_&#123;pi(n^(1&#x2F;6))+1&#125;,n)</span><br><span class="line">    memset(c,0,sizeof c);</span><br><span class="line">    add(1,F[1]);</span><br><span class="line">    for(int i&#x3D;2;val_id[i]&lt;n&#x2F;n_3;i++)&#123;</span><br><span class="line">        add(i,F[i] - F[i-1]);</span><br><span class="line">    &#125;</span><br><span class="line">    for(int k&#x3D;p_sz_3;k&gt;p_sz_6;k--)&#123;</span><br><span class="line">        int now &#x3D; val_id_num;</span><br><span class="line">        for(;val_id[now]&gt;&#x3D;n&#x2F;n_3;now--)&#123;</span><br><span class="line">            int e &#x3D; 1;</span><br><span class="line">            ll _p &#x3D; p[k];</span><br><span class="line">            while(val_id[now]&#x2F;_p)&#123;</span><br><span class="line">                if(val_id[now]&#x2F;_p&gt;&#x3D;n&#x2F;n_3)&#123;</span><br><span class="line">                    F[now] +&#x3D; F[get_id(val_id[now]&#x2F;_p)]*f(p[k],e);</span><br><span class="line">                &#125;</span><br><span class="line">                else&#123;</span><br><span class="line">                    F[now] +&#x3D; sum(get_id(val_id[now]&#x2F;_p))*f(p[k],e);</span><br><span class="line">                &#125;</span><br><span class="line">                _p *&#x3D; p[k];</span><br><span class="line">                e++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        if(k&#x3D;&#x3D;1) break;</span><br><span class="line">        &#x2F;&#x2F;cout &lt;&lt; &quot;******&quot; &lt;&lt; p[k] &lt;&lt; &quot;******&quot; &lt;&lt; n&#x2F;n_3 &lt;&lt; endl;</span><br><span class="line">        update_bfs(k,-1);&#x2F;&#x2F;&#x2F;bfs to update [lpf(i)&#x3D;&#x3D;P&#123;k-1&#125;]f(i)</span><br><span class="line">    &#125;</span><br><span class="line">    for(int i&#x3D;1;i&lt;&#x3D;val_id_num&amp;&amp;val_id[i]&lt;n&#x2F;n_3;i++)</span><br><span class="line">        F[i] &#x3D; sum(i);</span><br><span class="line">&#125;</span><br><span class="line">void get_f(ll n)&#123;</span><br><span class="line">    for(int k&#x3D;p_sz_6;k&gt;&#x3D;1;k--)&#123;</span><br><span class="line">        for(int now &#x3D; val_id_num;now&gt;&#x3D;1;now--)&#123;</span><br><span class="line">            int e &#x3D; 1;</span><br><span class="line">            ll _p &#x3D; p[k];</span><br><span class="line">            while(val_id[now]&#x2F;_p)&#123;</span><br><span class="line">                    F[now] +&#x3D; F[get_id(val_id[now]&#x2F;_p)]*f(p[k],e);</span><br><span class="line">                _p *&#x3D; p[k];</span><br><span class="line">                e++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">int main()&#123;&#x2F;&#x2F;n &#x3D; 1000000000; &#x2F;&#x2F;1e10:455052511,0.83s&#x2F;0.58s 1e12:37607912018 9.224s&#x2F;5.105s</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    init();</span><br><span class="line">    get_f_p(n,2);</span><br><span class="line">    get_f_3(n);</span><br><span class="line">    get_f_6(n);</span><br><span class="line">    get_f(n);</span><br><span class="line">    for(int i&#x3D;1;i&lt;&#x3D;val_id_num;i++)&#123;</span><br><span class="line">        cout &lt;&lt; val_id[i] &lt;&lt; &quot; : &quot; &lt;&lt; F[i] &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#96;&#96;&#96;  </span><br><span class="line"></span><br><span class="line">## 三, 唯一分解定理(算术基本定理)</span><br><span class="line"></span><br><span class="line">暴力分解即可</span><br><span class="line"></span><br><span class="line">代码没有</span><br><span class="line"></span><br><span class="line">## 四, GCD&#x2F;EXGCD</span><br><span class="line"></span><br><span class="line">用途: **ax + by &#x3D; gcd(a,b) 方程求解** </span><br><span class="line"></span><br><span class="line">&#96;&#96;&#96;C++</span><br><span class="line">#include &lt;bits&#x2F;stdc++.h&gt;</span><br><span class="line">using namespace std;</span><br><span class="line">int a, b, x, y；</span><br><span class="line"></span><br><span class="line">void EXGCD(int a, int b, int &amp;x, int &amp;y) &#123;</span><br><span class="line">    if (!b) &#123; x &#x3D; 1; y &#x3D; 0; return; &#125;</span><br><span class="line">    EXGCD(b, a%b, y, x);</span><br><span class="line">    y -&#x3D; a &#x2F; b * x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">int main() &#123;</span><br><span class="line">    scanf(&quot;%d %d&quot;, &amp;a, &amp;b);</span><br><span class="line">    EXGCD(a,b,x,y);</span><br><span class="line">    printf(&quot;%d %d&quot;, x, y);</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>使用STL的代码:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pir pair<span class="meta-string">&lt;int,int&gt;    </span></span></span><br><span class="line"><span class="keyword">int</span> a, b, x, y;</span><br><span class="line"></span><br><span class="line"><span class="function">pir <span class="title">EXGCD</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!b) <span class="keyword">return</span> make_pair(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    pir tmp = EXGCD(b, a%b);</span><br><span class="line">    <span class="keyword">return</span> make_pair(tmp.second ,tmp.first - a/b*tmp.second);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d %d"</span>, &amp;a, &amp;b);</span><br><span class="line">    pir ans = EXGCD(a,b);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d %d"</span>,ans.first,ans.second);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h2 id="五-中国剩余定理-孙子定理"><a href="#五-中国剩余定理-孙子定理" class="headerlink" title="五, 中国剩余定理(孙子定理)"></a>五, 中国剩余定理(孙子定理)</h2><h3 id="1-CRT-保证-m-1-m-2…m-n-之间两两互质，求最小的x"><a href="#1-CRT-保证-m-1-m-2…m-n-之间两两互质，求最小的x" class="headerlink" title="1.CRT(保证$m_1,m_2…m_n$之间两两互质，求最小的x)"></a>1.CRT(保证$m_1,m_2…m_n$之间两两互质，求最小的<em>x</em>)</h3><p>用途: <strong>同余方程组求解!</strong> </p>
<p><img src="C:%5CUsers%5CDELL%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20201006204034516.png" alt="image-20201006204034516"></p>
<p>我们求出了任意一个满足条件的<em>x</em>之后，只需要对其模<em>M</em>就是最终的答案(因为<em>M</em>M是所有数的<em>lcm</em>)</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="comment">//扩展欧几里得算法 </span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">gcd</span><span class="params">(ll a,ll b,ll &amp;d,ll &amp;x,ll &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(b==<span class="number">0</span>)&#123;</span><br><span class="line">        d=a;</span><br><span class="line">        x=<span class="number">1</span>,y=<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;<span class="comment">//else不能省略 </span></span><br><span class="line">        gcd(b,a%b,d,y,x);</span><br><span class="line">        y-=(a/b)*x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//中国剩余定理 </span></span><br><span class="line"><span class="function">ll <span class="title">China</span><span class="params">(<span class="keyword">int</span> n,ll *m,ll *a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll M=<span class="number">1</span>,d,y,x=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++) M*=m[i];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">        ll w=M/m[i];</span><br><span class="line">        gcd(m[i],w,d,d,y);</span><br><span class="line">        x=(x+y*w*a[i])%M;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (x+M)%M;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="2-EXCRT-m-1-m-2…m-n-之间不再限制互质，求最小的x"><a href="#2-EXCRT-m-1-m-2…m-n-之间不再限制互质，求最小的x" class="headerlink" title="2. EXCRT($m_1,m_2…m_n$之间不再限制互质，求最小的x)"></a>2. EXCRT($m_1,m_2…m_n$之间不再限制互质，求最小的<em>x</em>)</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">100000</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line">ll a[N],r[N];</span><br><span class="line"><span class="function">ll <span class="title">exgcd</span><span class="params">(ll a,ll b,ll &amp;x,ll &amp;y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(b==<span class="number">0</span>)&#123;</span><br><span class="line">        x=<span class="number">1</span>,y=<span class="number">0</span>;<span class="keyword">return</span> a;</span><br><span class="line">    &#125;    </span><br><span class="line">    ll ret=exgcd(b,a%b,y,x);</span><br><span class="line">    y-=(a/b)*x;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">excrt</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ll M=a[<span class="number">1</span>],R=r[<span class="number">1</span>],x,y,d;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=n;i++)&#123;</span><br><span class="line">        d=exgcd(M,a[i],x,y);</span><br><span class="line">        <span class="keyword">if</span>((R-r[i])%d) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        x=(R-r[i])/d*x%a[i];</span><br><span class="line">        R-=M*x;</span><br><span class="line">        M=M/d*a[i];</span><br><span class="line">        R%=M;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (R%M+M)%M;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n)!=EOF)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%lld%lld"</span>,&amp;a[i],&amp;r[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,excrt());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="六-米勒罗宾-大素数测试"><a href="#六-米勒罗宾-大素数测试" class="headerlink" title="六, 米勒罗宾_大素数测试"></a>六, 米勒罗宾_大素数测试</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> S = <span class="number">8</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//计算ret = (a*b)%c a, b, c &lt; 2^63</span></span><br><span class="line"><span class="function">ll <span class="title">mult_mod</span><span class="params">(ll a, ll b, ll c)</span> </span>&#123;</span><br><span class="line">    a %= c;</span><br><span class="line">    b %= c;</span><br><span class="line">    ll ans = <span class="number">0</span>;</span><br><span class="line">    ll tmp = a;</span><br><span class="line">    <span class="keyword">while</span> (b) &#123;</span><br><span class="line">        <span class="keyword">if</span> (b &amp; <span class="number">1</span>) &#123;</span><br><span class="line">            ans += tmp;</span><br><span class="line">            <span class="keyword">if</span> (ans &gt; c) &#123;</span><br><span class="line">                ans -= c;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        tmp &lt;&lt;= <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (tmp &gt; c) &#123;</span><br><span class="line">            tmp -= c;</span><br><span class="line">        &#125;</span><br><span class="line">        b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//计算 ret = (a^n) % mod</span></span><br><span class="line"><span class="function">ll <span class="title">pow_mod</span><span class="params">(ll a, ll n, ll mod)</span> </span>&#123;</span><br><span class="line">    ll ans = <span class="number">1</span>;</span><br><span class="line">    ll tmp = a % mod;</span><br><span class="line">    <span class="keyword">while</span> (n) &#123;</span><br><span class="line">        <span class="keyword">if</span> (n &amp; <span class="number">1</span>) &#123;</span><br><span class="line">            ans = mult_mod(ans, tmp, mod);</span><br><span class="line">        &#125;</span><br><span class="line">        tmp = mult_mod(tmp, tmp, mod);</span><br><span class="line">        n &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//通过 a^(n-1) = 1(mod n) 判断n是不是素数</span></span><br><span class="line"><span class="comment">//n - 1 = x * 2 ^ t 中间使用二次判断</span></span><br><span class="line"><span class="comment">//是合数返回ture, 不一定是合数返回false</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check</span><span class="params">(ll a, ll n, ll x, ll t)</span> </span>&#123;</span><br><span class="line">    ll ans = pow_mod(a, x, n);</span><br><span class="line">    ll last = ans;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= t; ++i) &#123;</span><br><span class="line">        ans = mult_mod(ans, ans, n);</span><br><span class="line">        <span class="keyword">if</span> (ans == <span class="number">1</span> &amp;&amp; last != <span class="number">1</span> &amp;&amp; last != n - <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        last = ans;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (ans != <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">Miller_Rabin</span><span class="params">(ll n)</span> </span>&#123; <span class="comment">//是素数返回 ture, 否则返回false</span></span><br><span class="line">    <span class="keyword">if</span> (n &lt; <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (n == <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ((n &amp; <span class="number">1</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    ll x = n - <span class="number">1</span>;</span><br><span class="line">    ll t = <span class="number">0</span>;</span><br><span class="line">    t = (ll)log2(x &amp; (-x));</span><br><span class="line">    x = x / (x &amp; (-x));</span><br><span class="line">    srand(time(<span class="literal">NULL</span>));</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; S; ++i) &#123;</span><br><span class="line">        ll a = rand() % (n - <span class="number">1</span>) + <span class="number">1</span>;<span class="comment">//产生随机数a, 并控制其在0 ~ n-1之间</span></span><br><span class="line">        <span class="keyword">if</span> (check(a, n, x, t)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> t, ans;</span><br><span class="line">    ll tem;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;t);</span><br><span class="line">    ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (t--) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;tem);</span><br><span class="line">        <span class="keyword">if</span> (Miller_Rabin(tem)) &#123;</span><br><span class="line">            ans++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="增-Pallord-rho-大整数分解质因数"><a href="#增-Pallord-rho-大整数分解质因数" class="headerlink" title="增: Pallord_rho 大整数分解质因数"></a>增: Pallord_rho 大整数分解质因数</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> maxn 10000+10</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> cle(a) memset(a, 0, sizeof(a))</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-5</span>;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> S = <span class="number">30</span>;<span class="comment">//随机算法判定次数，S越大，判错概率越小</span></span><br><span class="line"><span class="comment">//计算 (a*b)%c.   a,b都是long long的数，直接相乘可能溢出的</span></span><br><span class="line"><span class="comment">//  a,b,c &lt;2^63</span></span><br><span class="line"><span class="function">ll <span class="title">mult_mod</span><span class="params">(ll a, ll b, ll c)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    a %= c;</span><br><span class="line">    b %= c;</span><br><span class="line">    ll ret = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (b)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (b &amp; <span class="number">1</span>) &#123; ret += a; ret %= c; &#125;</span><br><span class="line">        a &lt;&lt;= <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (a &gt;= c)a %= c;</span><br><span class="line">        b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">pow_mod</span><span class="params">(ll x, ll n, ll mod)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (n == <span class="number">1</span>)<span class="keyword">return</span> x % mod;</span><br><span class="line">    x %= mod;</span><br><span class="line">    ll tmp = x;</span><br><span class="line">    ll ret = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (n)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (n &amp; <span class="number">1</span>) ret = mult_mod(ret, tmp, mod);</span><br><span class="line">        tmp = mult_mod(tmp, tmp, mod);</span><br><span class="line">        n &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//以a为基,n-1=x*2^t      a^(n-1)=1(mod n)  验证n是不是合数</span></span><br><span class="line"><span class="comment">//一定是合数返回true,不一定返回false</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check</span><span class="params">(ll a, ll n, ll x, ll t)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll ret = pow_mod(a, x, n);</span><br><span class="line">    ll last = ret;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= t; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        ret = mult_mod(ret, ret, n);</span><br><span class="line">        <span class="keyword">if</span> (ret == <span class="number">1</span> &amp;&amp; last != <span class="number">1</span> &amp;&amp; last != n - <span class="number">1</span>) <span class="keyword">return</span> <span class="literal">true</span>;<span class="comment">//合数</span></span><br><span class="line">        last = ret;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (ret != <span class="number">1</span>) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// Miller_Rabin()算法素数判定</span></span><br><span class="line"><span class="comment">//是素数返回true.(可能是伪素数，但概率极小)</span></span><br><span class="line"><span class="comment">//合数返回false;</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">Miller_Rabin</span><span class="params">(ll n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (n &lt; <span class="number">2</span>)<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span> (n == <span class="number">2</span>)<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">if</span> ((n &amp; <span class="number">1</span>) == <span class="number">0</span>) <span class="keyword">return</span> <span class="literal">false</span>;<span class="comment">//偶数</span></span><br><span class="line">    ll x = n - <span class="number">1</span>;</span><br><span class="line">    ll t = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> ((x &amp; <span class="number">1</span>) == <span class="number">0</span>) &#123; x &gt;&gt;= <span class="number">1</span>; t++; &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; S; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        ll a = rand() % (n - <span class="number">1</span>) + <span class="number">1</span>;<span class="comment">//rand()需要stdlib.h头文件</span></span><br><span class="line">        <span class="keyword">if</span> (check(a, n, x, t))</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;<span class="comment">//合数</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line">ll factor[<span class="number">100</span>];<span class="comment">//质因数分解结果（刚返回时是无序的）</span></span><br><span class="line"><span class="keyword">int</span> tol;<span class="comment">//质因数的个数。数组小标从0开始</span></span><br><span class="line"><span class="function">ll <span class="title">gcd</span><span class="params">(ll a, ll b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (a == <span class="number">0</span>)<span class="keyword">return</span> <span class="number">1</span>;<span class="comment">//???????</span></span><br><span class="line">    <span class="keyword">if</span> (a &lt; <span class="number">0</span>) <span class="keyword">return</span> gcd(-a, b);</span><br><span class="line">    <span class="keyword">while</span> (b)</span><br><span class="line">    &#123;</span><br><span class="line">        ll t = a % b;</span><br><span class="line">        a = b;</span><br><span class="line">        b = t;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">Pollard_rho</span><span class="params">(ll x, ll c)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll i = <span class="number">1</span>, k = <span class="number">2</span>;</span><br><span class="line">    ll x0 = rand() % x;</span><br><span class="line">    ll y = x0;</span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        i++;</span><br><span class="line">        x0 = (mult_mod(x0, x0, x) + c) % x;</span><br><span class="line">        ll d = gcd(y - x0, x);</span><br><span class="line">        <span class="keyword">if</span> (d != <span class="number">1</span> &amp;&amp; d != x) <span class="keyword">return</span> d;</span><br><span class="line">        <span class="keyword">if</span> (y == x0) <span class="keyword">return</span> x;</span><br><span class="line">        <span class="keyword">if</span> (i == k) &#123; y = x0; k += k; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//对n进行素因子分解</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">findfac</span><span class="params">(ll n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (Miller_Rabin(n))<span class="comment">//素数</span></span><br><span class="line">    &#123;</span><br><span class="line">        factor[tol++] = n;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    ll p = n;</span><br><span class="line">    <span class="keyword">while</span> (p &gt;= n)p = Pollard_rho(p, rand() % (n - <span class="number">1</span>) + <span class="number">1</span>);</span><br><span class="line">    findfac(p);</span><br><span class="line">    findfac(n / p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ll n;</span><br><span class="line">    <span class="keyword">int</span> t;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; t;</span><br><span class="line">    <span class="keyword">while</span> (t--) &#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">        <span class="keyword">if</span> (n == <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="comment">//cout &lt;&lt; "no" &lt;&lt; '\n';</span></span><br><span class="line">            </span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        tol = <span class="number">0</span>;</span><br><span class="line">        findfac(n);</span><br><span class="line">        sort(factor, factor + tol); <span class="comment">//素因子排序</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tol; i++) &#123; <span class="comment">//输出所有素因子!!! 有重复的哦: 100 -&gt; 2 2 5 5</span></span><br><span class="line">            <span class="built_in">cout</span> &lt;&lt; factor[i] &lt;&lt; <span class="string">' '</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//质因子</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="七-乘法逆元"><a href="#七-乘法逆元" class="headerlink" title="七, 乘法逆元"></a>七, 乘法逆元</h2><h3 id="1-by-EXGCD"><a href="#1-by-EXGCD" class="headerlink" title="1.by EXGCD"></a>1.by EXGCD</h3><p>O(logN)</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"> <span class="number">1</span> <span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"> <span class="number">2</span> <span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"> <span class="number">3</span> <span class="function">ll <span class="title">exgcd</span><span class="params">(ll a,ll b,ll &amp;x,ll &amp;y)</span> </span>&#123;</span><br><span class="line"> <span class="number">4</span>     <span class="keyword">if</span>(!b) &#123;</span><br><span class="line"> <span class="number">5</span>         x=<span class="number">1</span>,y=<span class="number">0</span>;</span><br><span class="line"> <span class="number">6</span>         <span class="keyword">return</span> a;</span><br><span class="line"> <span class="number">7</span>     &#125;</span><br><span class="line"> <span class="number">8</span>     ll res=exgcd(b,a%b,y,x);</span><br><span class="line"> <span class="number">9</span>     y-=a/b*x;       <span class="comment">///x=x1,y=x1-a/b*y1   x1,y1代表下一状态</span></span><br><span class="line"><span class="number">10</span>     <span class="keyword">return</span> res;</span><br><span class="line"><span class="number">11</span> &#125;</span><br><span class="line"><span class="number">12</span> <span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function">13 </span>&#123;</span><br><span class="line"><span class="number">14</span>     ll a,p,x,y;  <span class="comment">///扩展欧几里得计算a的逆元（mod p）</span></span><br><span class="line"><span class="number">15</span>     <span class="built_in">scanf</span>(<span class="string">"%lld%lld"</span>,&amp;a,&amp;p);</span><br><span class="line"><span class="number">16</span>     ll d=exgcd(a,p,x,y);</span><br><span class="line"><span class="number">17</span>     <span class="built_in">printf</span>(d==<span class="number">1</span>?<span class="string">"%lld"</span>:<span class="string">"-1"</span>,(x+p)%p);<span class="comment">///最大公约数不为1，逆元不存在，输出-1</span></span><br><span class="line"><span class="number">18</span>     <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="number">19</span> &#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-费马小定理"><a href="#2-费马小定理" class="headerlink" title="2.费马小定理"></a>2.费马小定理</h3><p>O(logP) 模为素数p的情况下</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"> <span class="number">1</span> <span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"> <span class="number">2</span> <span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"> <span class="number">3</span> <span class="function">ll <span class="title">quickpowmod</span><span class="params">(ll a,ll b,ll mod)</span> </span>&#123;</span><br><span class="line"> <span class="number">4</span>     ll ans=<span class="number">1</span>;</span><br><span class="line"> <span class="number">5</span>     <span class="keyword">while</span>(b) &#123;</span><br><span class="line"> <span class="number">6</span>         <span class="keyword">if</span>(b&amp;<span class="number">1</span>) ans=(ans*a)%mod;</span><br><span class="line"> <span class="number">7</span>         b&gt;&gt;=<span class="number">1</span>;</span><br><span class="line"> <span class="number">8</span>         a=(a*a)%mod;</span><br><span class="line"> <span class="number">9</span>     &#125;</span><br><span class="line"><span class="number">10</span>     <span class="keyword">return</span> ans;</span><br><span class="line"><span class="number">11</span> &#125;</span><br><span class="line"><span class="number">12</span> <span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function">13 </span>&#123;</span><br><span class="line"><span class="number">14</span>     ll a,p;  <span class="comment">///费马小定理计算a的逆元（mod p）</span></span><br><span class="line"><span class="number">15</span>     <span class="built_in">scanf</span>(<span class="string">"%lld%lld"</span>,&amp;a,&amp;p);</span><br><span class="line"><span class="number">16</span>     ll inva=quickpowmod(a,p<span class="number">-2</span>,p);</span><br><span class="line"><span class="number">17</span>     <span class="built_in">printf</span>(<span class="string">"%lld"</span>,inva);</span><br><span class="line"><span class="number">18</span>     <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="number">19</span> &#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-逆元打表"><a href="#3-逆元打表" class="headerlink" title="3.逆元打表"></a>3.逆元打表</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">inv[<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span> ; i &lt;= n; i++)</span><br><span class="line">    inv[i]=(<span class="keyword">long</span> <span class="keyword">long</span>)(p - p/i) * inv[p % i] % p;</span><br></pre></td></tr></table></figure>



<h2 id="八-矩阵快速幂"><a href="#八-矩阵快速幂" class="headerlink" title="八, 矩阵快速幂"></a>八, 矩阵快速幂</h2><p>模板是求解 : F（n）= F（n-1）+F（n-2）+F（n-3）</p>
<p>具体题目具体分析, 推算矩阵</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> ll MOD = <span class="number">1000000007</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">mat</span> &#123;</span></span><br><span class="line">    ll a[<span class="number">3</span>][<span class="number">3</span>];</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function">mat <span class="title">mat_mul</span><span class="params">(mat a,mat b)</span> </span>&#123;</span><br><span class="line">    mat res;</span><br><span class="line">    <span class="built_in">memset</span>(res.a,<span class="number">0</span>,<span class="keyword">sizeof</span>(res.a));</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i&lt;=<span class="number">2</span> ; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j&lt;=<span class="number">2</span> ; j++) &#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>; k&lt;=<span class="number">2</span> ; k++) &#123;</span><br><span class="line">                res.a[i][j] += ( a.a[i][k] * b.a[k][j])%MOD;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">mat_pow</span><span class="params">(ll n)</span> </span>&#123;</span><br><span class="line">    mat c,res;</span><br><span class="line">    <span class="built_in">memset</span>(c.a,<span class="number">0</span>,<span class="keyword">sizeof</span>(c.a));</span><br><span class="line">    <span class="built_in">memset</span>(res.a,<span class="number">0</span>,<span class="keyword">sizeof</span>(res.a));</span><br><span class="line">    c.a[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    c.a[<span class="number">0</span>][<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    c.a[<span class="number">0</span>][<span class="number">2</span>] = <span class="number">1</span>;</span><br><span class="line">    c.a[<span class="number">1</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    c.a[<span class="number">2</span>][<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">3</span> ; i++) &#123;</span><br><span class="line">        res.a[i][i] = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(n) &#123;</span><br><span class="line">        <span class="keyword">if</span>(n&amp;<span class="number">1</span>) &#123;</span><br><span class="line">            res = mat_mul(res,c);</span><br><span class="line">        &#125;</span><br><span class="line">        c = mat_mul(c,c);</span><br><span class="line">        n &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (res.a[<span class="number">0</span>][<span class="number">0</span>])%MOD;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ll n;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%lld"</span>,&amp;n)!=EOF) &#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">//    n -= 1;</span></span><br><span class="line"></span><br><span class="line">        ll ans = mat_pow(n);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ans);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="九-卢卡斯定理"><a href="#九-卢卡斯定理" class="headerlink" title="九, 卢卡斯定理"></a>九, 卢卡斯定理</h2><h3 id="1-Lucas-模数p是质数"><a href="#1-Lucas-模数p是质数" class="headerlink" title="1.Lucas (模数p是质数)"></a>1.Lucas (模数p是质数)</h3><p>给定$n,m,p (1 &lt;= n,m,p &lt;= 10^5)$ , 且p为素数<br> 求 $C^n_{n+m} mod P$</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"><span class="keyword">const</span> LL N=<span class="number">1e5</span>+<span class="number">2</span>; <span class="comment">//1e5 !!!</span></span><br><span class="line"></span><br><span class="line">LL a[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(LL p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	a[<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=p;++i)a[i]=a[i<span class="number">-1</span>]*i%p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">exgcd</span><span class="params">(LL a,LL b,LL &amp;x,LL &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(!b)&#123;</span><br><span class="line">		x=<span class="number">1</span>;</span><br><span class="line">		y=<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	exgcd(b,a%b,y,x);</span><br><span class="line">	y-=a/b*x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">ksm</span><span class="params">(LL x,LL n,LL mod)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	LL ans=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">while</span>(n)&#123;</span><br><span class="line">		<span class="keyword">if</span>(n&amp;<span class="number">1</span>)ans=ans*x%mod;</span><br><span class="line">		n&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">		x=x*x%mod;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">C</span><span class="params">(LL n,LL m,LL p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(n==m||m==<span class="number">0</span>)<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">if</span>(n&lt;m)<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">if</span>(m*<span class="number">2</span>&gt;n)m=n-m;						  <span class="comment">/*C(n,m)=c(n,n-m)*/</span></span><br><span class="line">	<span class="keyword">return</span> a[n]*ksm(a[m]*a[n-m],p<span class="number">-2</span>,p)%p;</span><br><span class="line">    <span class="comment">/*求(a[m]*a[n-m])在(mod p)意义下的乘法逆元*/</span>										<span class="comment">/*拓展欧几里得与费马小定理均可*/</span> </span><br><span class="line">	<span class="comment">/*LL x,y;</span></span><br><span class="line"><span class="comment">	exgcd(a[m]*a[n-m],p,x,y);</span></span><br><span class="line"><span class="comment">	return (a[n]*x%p+p)%p;*/</span> </span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">lucas</span><span class="params">(LL n,LL m,LL p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(!m)<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">return</span> lucas(n/p,m/p,p)*C(n%p,m%p,p)%p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	LL T,n,m,p;</span><br><span class="line">	<span class="built_in">cin</span>&gt;&gt;T;</span><br><span class="line">	<span class="keyword">while</span>(T--)&#123;</span><br><span class="line">		<span class="built_in">cin</span>&gt;&gt;n&gt;&gt;m&gt;&gt;p;</span><br><span class="line">		init(p);</span><br><span class="line">		<span class="built_in">cout</span>&lt;&lt;lucas(n+m,m,p)&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-EX-Lucas-模数p不一定是质数的时候"><a href="#2-EX-Lucas-模数p不一定是质数的时候" class="headerlink" title="2. EX-Lucas (模数p不一定是质数的时候)"></a>2. EX-Lucas (模数p不一定是质数的时候)</h3><p>求$C^m_n mod P$</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"><span class="keyword">const</span> LL N=<span class="number">1e5</span>+<span class="number">9</span>;</span><br><span class="line">LL A[N],M[N];</span><br><span class="line"><span class="function">LL <span class="title">ksm</span><span class="params">(LL x,LL n,LL mod)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	LL ans=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">while</span>(n)&#123;</span><br><span class="line">		<span class="keyword">if</span>(n&amp;<span class="number">1</span>)ans=ans*x%mod;</span><br><span class="line">		n&gt;&gt;=<span class="number">1</span>,x=x*x%mod;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">exgcd</span><span class="params">(LL a,LL b,LL &amp;x,LL &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(!b)x=<span class="number">1</span>,y=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">else</span> exgcd(b,a%b,y,x),y-=a/b*x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">inv</span><span class="params">(LL a,LL p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	LL x,y;</span><br><span class="line">	exgcd(a,p,x,y);</span><br><span class="line">	<span class="keyword">return</span> (x+p)%p?x:x+p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">get</span><span class="params">(LL n,LL pi,LL p)</span>									<span class="comment">/*求(与pi互素后的n!)%M[i]*/</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(!n)<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">	LL ans=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">if</span>(n/p)&#123;											<span class="comment">/*判断有无循环节 */</span> </span><br><span class="line">		<span class="keyword">for</span>(LL i=<span class="number">2</span>;i&lt;=p;++i)<span class="keyword">if</span>(i%pi)ans=ans*i%p;</span><br><span class="line">		ans=ksm(ans,n/p,p);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(LL i=<span class="number">2</span>;i&lt;=n%p;++i)<span class="keyword">if</span>(i%pi)ans=ans*i%p;			<span class="comment">/*循环节剩余部分*/</span> </span><br><span class="line">	<span class="keyword">return</span> ans*<span class="built_in">get</span>(n/pi,pi,p)%p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">exlucas</span><span class="params">(LL n,LL m,LL pi,LL p)</span>						<span class="comment">/*求A[i]*/</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	LL nn=<span class="built_in">get</span>(n,pi,p);									<span class="comment">/*求(与pi互素后的n)%M[i]*/</span> </span><br><span class="line">	LL mm=<span class="built_in">get</span>(m,pi,p);									<span class="comment">/*求(m!与pi互素后的m!)%M[i]*/</span> </span><br><span class="line">	LL nm=<span class="built_in">get</span>(n-m,pi,p);								<span class="comment">/*求(与pi互素后的(n-m)!)%M[i]*/</span> </span><br><span class="line">	LL k=<span class="number">0</span>;												<span class="comment">/*含质因数pi的数量*/</span> </span><br><span class="line">	<span class="keyword">for</span>(LL i=n;i;i/=pi)k+=i/pi;</span><br><span class="line">	<span class="keyword">for</span>(LL i=m;i;i/=pi)k-=i/pi;</span><br><span class="line">	<span class="keyword">for</span>(LL i=n-m;i;i/=pi)k-=i/pi;</span><br><span class="line">	<span class="keyword">return</span> nn*inv(mm,p)*inv(nm,p)*ksm(pi,k,p)%p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">crt</span><span class="params">(LL len,LL Lcm)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	LL ans=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(LL i=<span class="number">1</span>;i&lt;=len;++i)&#123;</span><br><span class="line">		LL Mi=Lcm/M[i];</span><br><span class="line">		ans=((ans+A[i]*inv(Mi,M[i])*Mi)%Lcm+Lcm)%Lcm;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	LL n,m,P,num;</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">cin</span>&gt;&gt;n&gt;&gt;m&gt;&gt;P)&#123;</span><br><span class="line">		<span class="keyword">if</span>(n&lt;m)&#123;</span><br><span class="line">			<span class="built_in">cout</span>&lt;&lt;<span class="number">0</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">			<span class="keyword">continue</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		num=<span class="number">0</span>;</span><br><span class="line">		<span class="built_in">memset</span>(A,<span class="number">0</span>,<span class="keyword">sizeof</span>(A));</span><br><span class="line">		<span class="built_in">memset</span>(M,<span class="number">0</span>,<span class="keyword">sizeof</span>(M));</span><br><span class="line">		<span class="keyword">for</span>(LL x=P,i=<span class="number">2</span>;i&lt;=P;++i)</span><br><span class="line">			<span class="keyword">if</span>(x%i==<span class="number">0</span>)&#123;</span><br><span class="line">				M[++num]=<span class="number">1</span>;</span><br><span class="line">				<span class="keyword">while</span>(x%i==<span class="number">0</span>)&#123;</span><br><span class="line">					M[num]*=i;</span><br><span class="line">					x/=i;</span><br><span class="line">				&#125;</span><br><span class="line">				A[num]=exlucas(n,m,i,M[num])%P;</span><br><span class="line">			&#125; </span><br><span class="line">		<span class="built_in">cout</span>&lt;&lt;crt(num,P)&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h2 id="十-多项式算法"><a href="#十-多项式算法" class="headerlink" title="十, 多项式算法"></a>十, 多项式算法</h2><h3 id="FFT-根据复数-答案是小数-非精确"><a href="#FFT-根据复数-答案是小数-非精确" class="headerlink" title="FFT(根据复数, 答案是小数, 非精确)"></a>FFT(根据复数, 答案是小数, 非精确)</h3><h3 id="NTT"><a href="#NTT" class="headerlink" title="NTT"></a>NTT</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long int</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Redge(u) for (int k = h[u],to; k; k = ed[k].nxt)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> REP(i,n) for (int i = 1; i &lt;= (n); i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BUG(s,n) for (int i = 1; i &lt;= (n); i++) cout&lt;&lt;s[i]&lt;&lt;<span class="meta-string">' '</span>; puts(<span class="meta-string">""</span>);</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">4000005</span>, maxm = <span class="number">100005</span>, INF = <span class="number">1000000000</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> out = <span class="number">0</span>, flag = <span class="number">1</span>; <span class="keyword">char</span> c = getchar();</span><br><span class="line">    <span class="keyword">while</span> (c &lt; <span class="number">48</span> || c &gt; <span class="number">57</span>) &#123; <span class="keyword">if</span> (c == <span class="string">'-'</span>) flag = <span class="number">-1</span>; c = getchar(); &#125;</span><br><span class="line">    <span class="keyword">while</span> (c &gt;= <span class="number">48</span> &amp;&amp; c &lt;= <span class="number">57</span>) &#123; out = (out &lt;&lt; <span class="number">3</span>) + (out &lt;&lt; <span class="number">1</span>) + c - <span class="number">48</span>; c = getchar(); &#125;</span><br><span class="line">    <span class="keyword">return</span> out * flag;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> G = <span class="number">3</span>, P = (<span class="number">119</span> &lt;&lt; <span class="number">23</span>) + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, L, R[maxn];</span><br><span class="line"><span class="keyword">int</span> A[maxn], B[maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; b; b &gt;&gt;= <span class="number">1</span>, a = <span class="number">1l</span>l * a * a % P)</span><br><span class="line">        <span class="keyword">if</span> (b &amp; <span class="number">1</span>) ans = <span class="number">1l</span>l * ans * a % P;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">NTT</span><span class="params">(<span class="keyword">int</span>* a, <span class="keyword">int</span> f)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) <span class="keyword">if</span> (i &lt; R[i]) swap(a[i], a[R[i]]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">int</span> gn = qpow(G, (P - <span class="number">1</span>) / (i &lt;&lt; <span class="number">1</span>));</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; j += (i &lt;&lt; <span class="number">1</span>)) &#123;</span><br><span class="line">            <span class="keyword">int</span> g = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; i; k++, g = <span class="number">1l</span>l * g * gn % P) &#123;</span><br><span class="line">                <span class="keyword">int</span> x = a[j + k], y = <span class="number">1l</span>l * g * a[j + k + i] % P;</span><br><span class="line">                a[j + k] = (x + y) % P; a[j + k + i] = (x - y + P) % P;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (f == <span class="number">1</span>) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">int</span> nv = qpow(n, P - <span class="number">2</span>); reverse(a + <span class="number">1</span>, a + n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) a[i] = <span class="number">1l</span>l * a[i] * nv % P;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    n = <span class="built_in">read</span>();</span><br><span class="line">    m = <span class="built_in">read</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; i++) A[i] = <span class="built_in">read</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= m; i++) B[i] = <span class="built_in">read</span>();</span><br><span class="line">    m = n + m;                                <span class="comment">//m = n + m!</span></span><br><span class="line">    <span class="keyword">for</span> (n = <span class="number">1</span>; n &lt;= m; n &lt;&lt;= <span class="number">1</span>)</span><br><span class="line">        L++;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">        R[i] = (R[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (L - <span class="number">1</span>));</span><br><span class="line">    NTT(A, <span class="number">1</span>);</span><br><span class="line">    NTT(B, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">        A[i] = <span class="number">1l</span>l * A[i] * B[i] % P;</span><br><span class="line">    NTT(A, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= m; i++)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d "</span>, A[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="十一-康托展开-逆康托展开"><a href="#十一-康托展开-逆康托展开" class="headerlink" title="十一, 康托展开/逆康托展开"></a>十一, 康托展开/逆康托展开</h2><h3 id="康托展开-某排列映射一个值"><a href="#康托展开-某排列映射一个值" class="headerlink" title="康托展开, 某排列映射一个值"></a>康托展开, 某排列映射一个值</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//对前 10 个自然数(0 ~ 9)的阶乘存入表</span></span><br><span class="line"><span class="comment">//以免去对其额外的计算</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> fact[<span class="number">10</span>] = &#123;<span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">24</span>, <span class="number">120</span>, <span class="number">720</span>, <span class="number">5040</span>, <span class="number">40320</span>, <span class="number">362880</span>&#125;;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @brief 康拓展开</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * @param[in] permutation 输入的一个全排列</span></span><br><span class="line"><span class="comment"> * @param[out] num 输入的康拓映射，即是第几个全排列</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">contor</span><span class="params">(<span class="keyword">const</span> <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; permutation)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> len = permutation.<span class="built_in">size</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i) &#123;</span><br><span class="line">        <span class="keyword">int</span> cnt = <span class="number">0</span>; <span class="comment">// 在 i 之后，比 i 还小的有几个</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt; len; ++j)</span><br><span class="line">            <span class="keyword">if</span> (permutation[i] &gt; permutation[j]) ++cnt;</span><br><span class="line">        num += cnt * fact[len - i - <span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> num + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="反求排列"><a href="#反求排列" class="headerlink" title="反求排列"></a>反求排列</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//对前 10 个自然数(0 ~ 9)的阶乘存入表</span></span><br><span class="line"><span class="comment">//以免去对其额外的计算</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> fact[<span class="number">10</span>] = &#123;<span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">24</span>, <span class="number">120</span>, <span class="number">720</span>, <span class="number">5040</span>, <span class="number">40320</span>, <span class="number">362880</span>&#125;;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @brief 逆康拓展开</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * @param[in] bits 给定全排列的使用数字个数</span></span><br><span class="line"><span class="comment"> * @param[in] num 给定全排列的次位</span></span><br><span class="line"><span class="comment"> * @param[out] permutation 输出对应的全排列</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">revContor</span><span class="params">(<span class="keyword">int</span> bits, <span class="keyword">int</span> num)</span> </span>&#123;</span><br><span class="line">    num = num - <span class="number">1</span>; <span class="comment">//有 num - 1 个排列比目标序列要小</span></span><br><span class="line">    <span class="function"><span class="built_in">vector</span>&lt;<span class="keyword">bool</span>&gt; <span class="title">vis</span><span class="params">(bits + <span class="number">1</span>, <span class="literal">false</span>)</span></span>;</span><br><span class="line">    <span class="function"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">permutation</span><span class="params">(bits, <span class="number">-1</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> n, residue = num;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; bits; ++i) &#123;</span><br><span class="line">        n = residue / (fact[bits - i - <span class="number">1</span>]);</span><br><span class="line">        residue = residue % (fact[bits - i - <span class="number">1</span>]);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= bits; ++j) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!vis[j] &amp;&amp; !(n--)) &#123;</span><br><span class="line">                vis[j] = <span class="literal">true</span>;</span><br><span class="line">                permutation[i] = j;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> permutation;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="十二-日期计算"><a href="#十二-日期计算" class="headerlink" title="十二, 日期计算"></a>十二, 日期计算</h2><h3 id="吉姆拉尔森公式"><a href="#吉姆拉尔森公式" class="headerlink" title="吉姆拉尔森公式"></a>吉姆拉尔森公式</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">CaculateWeekDay</span><span class="params">(<span class="keyword">int</span> y, <span class="keyword">int</span> m, <span class="keyword">int</span> d)</span> </span>&#123; <span class="comment">//年月日, 注意: 1/2月要当成上一年的13/14月</span></span><br><span class="line">    <span class="keyword">if</span> (m == <span class="number">1</span> || m == <span class="number">2</span>) &#123;</span><br><span class="line">        m += <span class="number">12</span>;</span><br><span class="line">        y--;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> iWeek = (d + <span class="number">2</span> * m + <span class="number">3</span> * (m + <span class="number">1</span>) / <span class="number">5</span> + y + y / <span class="number">4</span> - y / <span class="number">100</span> + y / <span class="number">400</span>) % <span class="number">7</span>;</span><br><span class="line">    <span class="keyword">return</span> iWeek; <span class="comment">// (0 - 6)</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="十三-容斥原理"><a href="#十三-容斥原理" class="headerlink" title="十三, 容斥原理"></a>十三, 容斥原理</h2><p>递归/暴力</p>
<p>若在n较大的情况下，应该采用递归进行计算，位运算计算循环次数太多，反而很慢。<br>在集合1，2，3…600,中，取出能被2，3，5，整除的数的个数</p>
<h3 id="位操作"><a href="#位操作" class="headerlink" title="位操作:"></a>位操作:</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> p[] = &#123; <span class="number">2</span>,<span class="number">3</span>,<span class="number">5</span> &#125;;</span><br><span class="line"><span class="keyword">int</span> cnt = <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">cal</span><span class="params">(<span class="keyword">int</span> n = <span class="number">600</span>)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; (<span class="number">1</span> &lt;&lt; cnt); i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> t = i, tmp = <span class="number">1</span>, k = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> len = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (t) &#123;</span><br><span class="line">            <span class="keyword">if</span> (t &amp; <span class="number">1</span>) &#123;</span><br><span class="line">                tmp *= p[k];</span><br><span class="line">                len++;</span><br><span class="line">            &#125;</span><br><span class="line">            t &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">            k++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (len &amp; <span class="number">1</span>) res += n / tmp;</span><br><span class="line">        <span class="keyword">else</span> res -= n / tmp;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; cal() &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="递归版"><a href="#递归版" class="headerlink" title="递归版"></a>递归版</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> a[] = &#123; <span class="number">2</span>,<span class="number">3</span>,<span class="number">5</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> b = <span class="number">600</span>;</span><br><span class="line"><span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> n = <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> i, <span class="keyword">int</span> num, <span class="keyword">int</span> x, <span class="keyword">int</span> mu)</span> </span>&#123;  <span class="comment">//i表示第几个元素，num表示现在一共用了几个，x表示最多能用几个，mu表示当前取了的数的乘积</span></span><br><span class="line">    <span class="keyword">if</span> (num == x) &#123;</span><br><span class="line">        sum += b / mu;                <span class="comment">//b就表示600</span></span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (i == n) <span class="keyword">return</span>;             <span class="comment">//一共有n个，比如上面的2，3，5，一共有3个，</span></span><br><span class="line">    dfs(i + <span class="number">1</span>, num + <span class="number">1</span>, x, mu * a[i]);    <span class="comment">//a中存储的就是2，3，5，然后取或者不取</span></span><br><span class="line">    dfs(i + <span class="number">1</span>, num, x, mu);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">rong</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> s = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        sum = <span class="number">0</span>;</span><br><span class="line">        dfs(<span class="number">0</span>, <span class="number">0</span>, i, <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">if</span> (i &amp; <span class="number">1</span>) s += sum;        <span class="comment">//容斥定理</span></span><br><span class="line">        <span class="keyword">else</span> s -= sum;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> s;                    <span class="comment">//s为能被2，3，5整除的数的个数。</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> i, <span class="keyword">int</span> mu, <span class="keyword">int</span> num)</span> </span>&#123;</span><br><span class="line">    mu *= a[i];</span><br><span class="line">    <span class="keyword">if</span> (num % <span class="number">2</span>) sum += b / mu;</span><br><span class="line">    <span class="keyword">else</span> sum -= b / mu;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt; <span class="number">3</span>; j++) &#123;</span><br><span class="line">        dfs(j, mu, num + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, rong());</span><br><span class="line">    sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++) &#123;</span><br><span class="line">        dfs(i, <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, sum);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="从-m-中颜色中选择-k-种-给-n-个盒子染色-相邻盒子颜色不同"><a href="#从-m-中颜色中选择-k-种-给-n-个盒子染色-相邻盒子颜色不同" class="headerlink" title="从 m 中颜色中选择 k 种, 给 n 个盒子染色, 相邻盒子颜色不同"></a>从 m 中颜色中选择 k 种, 给 n 个盒子染色, 相邻盒子颜色不同</h3><h3 id="打表求-组合数-取模"><a href="#打表求-组合数-取模" class="headerlink" title="打表求 组合数(取模)"></a>打表求 组合数(取模)</h3><p>用不超过 k 种颜色涂完 n 个盒子的方案数为    $ x_k=k(k−1)^{n−1} $</p>
<p> n 个盒子，用 m 种颜色中选出 正好 k 种颜色，且相邻盒子颜色不同的方案数为:<br>$$<br>ans = C_{m}^{k} t m p=C_{m}^{k} x_{k}-C_{m}^{k-1} x_{k-1}+C_{m}^{k-2} x_{k-2}+\ldots+(-1)^{k} x_{1}<br>$$</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">#include&lt;stdio.h&gt;</span><br><span class="line">#include&lt;cstdio&gt;</span><br><span class="line">#include&lt;iostream&gt;</span><br><span class="line">using namespace std;</span><br><span class="line"></span><br><span class="line">#define ll long long</span><br><span class="line"></span><br><span class="line">const ll mod&#x3D;1e9+7;</span><br><span class="line">const int maxn&#x3D;1e6+10;</span><br><span class="line"></span><br><span class="line">int T;</span><br><span class="line">ll p[maxn], invp[maxn], inv[maxn];</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;(a^b)%p</span><br><span class="line">ll qp(ll a, ll b)&#123;</span><br><span class="line">    a %&#x3D; mod;</span><br><span class="line">    ll ret &#x3D; 1;</span><br><span class="line">    while(b)&#123;</span><br><span class="line">        if (b &amp; 1)</span><br><span class="line">            ret &#x3D; ret * a % mod;</span><br><span class="line">        a &#x3D; (a * a) % mod;</span><br><span class="line">        b &gt;&gt;&#x3D; 1;</span><br><span class="line">    &#125;</span><br><span class="line">    return ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void init()&#123;</span><br><span class="line">    p[0] &#x3D; 1;</span><br><span class="line">    for(int i &#x3D; 1; i &lt;&#x3D; 1000000; i++)</span><br><span class="line">        p[i] &#x3D; p[i - 1] * i % mod;</span><br><span class="line">    invp[1000000] &#x3D; qp(p[1000000], mod - 2);</span><br><span class="line">    for(int i &#x3D; 1000000 - 1; i&gt;&#x3D;0; i--)</span><br><span class="line">        invp[i] &#x3D; invp[i + 1] * (i + 1) % mod;</span><br><span class="line">    inv[1] &#x3D; 1;</span><br><span class="line">    for(int i &#x3D; 2; i &lt;&#x3D; 1000000; i++)</span><br><span class="line">        inv[i] &#x3D; 1ll * (mod - mod &#x2F; i) * inv[mod % i] % mod;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ll C(ll n, ll m)&#123;</span><br><span class="line">    return p[n] * invp[m] % mod * invp[n - m] % mod;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">    init();</span><br><span class="line">    scanf(&quot;%d&quot;,&amp;T);</span><br><span class="line">    while(T--)</span><br><span class="line">    &#123;</span><br><span class="line">        ll n,m,k;</span><br><span class="line">        scanf(&quot;%lld%lld%lld&quot;,&amp;n,&amp;m,&amp;k);</span><br><span class="line">        ll Cmk &#x3D; 1;</span><br><span class="line">        for(int i&#x3D;1; i&lt;&#x3D;k; i++)</span><br><span class="line">            Cmk &#x3D; Cmk * (m - k + i) % mod * inv[i] % mod;</span><br><span class="line">        ll tmp &#x3D; 0;</span><br><span class="line">        for(int i&#x3D;0; i&lt;k; i++)</span><br><span class="line">            if (i % 2 &#x3D;&#x3D; 0)</span><br><span class="line">                tmp &#x3D; (tmp + C(k, k-i) * (k - i) % mod * qp(k - i - 1, n - 1) % mod + mod) % mod;</span><br><span class="line">            else</span><br><span class="line">                tmp &#x3D; (tmp - C(k, k-i) * (k - i) % mod * qp(k - i - 1, n - 1) % mod + mod) % mod;</span><br><span class="line">        ll ans &#x3D; Cmk * tmp % mod;</span><br><span class="line">        printf(&quot;%lld\n&quot;, ans);</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="十四-欧拉降幂"><a href="#十四-欧拉降幂" class="headerlink" title="十四, 欧拉降幂"></a>十四, 欧拉降幂</h2><p>输入n, m<br>长度n序列, m是mod<br>q个查询, 每次输入l, r</p>
<p>求:<br>$$ w[l]^{w[l+…]^{w[r]}}$$</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="comment">//#include &lt;hash_map&gt;</span></span><br><span class="line"><span class="comment">//#include &lt;unordered_map&gt; //没快多点</span></span><br><span class="line"><span class="keyword">using</span> ll = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD(a,b) a&gt;=b?a%b+b:a  <span class="comment">//重定义取模，按照欧拉定理的条件</span></span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e6</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> is_prime[maxn];</span><br><span class="line"><span class="keyword">int</span> prime[maxn];</span><br><span class="line"><span class="keyword">int</span> phi[maxn];</span><br><span class="line"><span class="keyword">int</span> cnt;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    cnt = <span class="number">0</span>; <span class="comment">//统计素数个数</span></span><br><span class="line">    is_prime[<span class="number">1</span>] = <span class="number">1</span>; <span class="comment">//0代表是素数, 1不是素数</span></span><br><span class="line">    phi[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= maxn - <span class="number">10</span>; i++) &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (!is_prime[i]) &#123;</span><br><span class="line">            prime[++cnt] = i; <span class="comment">//i是素数, prime从下标[1]开始有记录</span></span><br><span class="line">            phi[i] = i - <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= cnt; j++) &#123; <span class="comment">// 1 到 cnt !</span></span><br><span class="line">            <span class="keyword">if</span> (prime[j] * i &gt;= maxn)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            is_prime[i * prime[j]] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (i % prime[j] == <span class="number">0</span>) &#123;</span><br><span class="line">                phi[i * prime[j]] = phi[i] * prime[j];</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                phi[i * prime[j]] = phi[i] * (prime[j] - <span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">unordered_map</span>&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; ma;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line">ll w[maxn], m, l, r, x;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">qpow</span><span class="params">(ll a, ll b, ll mod)</span> </span>&#123; <span class="comment">//快速幂</span></span><br><span class="line">    ll res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (b) &#123;</span><br><span class="line">        <span class="keyword">if</span> (b &amp; <span class="number">1</span>) res = MOD(res * a, mod);</span><br><span class="line">        a = MOD(a * a, mod);</span><br><span class="line">        b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">getphi</span><span class="params">(ll x)</span> </span>&#123;  <span class="comment">//求互质个数</span></span><br><span class="line">    <span class="keyword">if</span> (x &lt;= maxn - <span class="number">10</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> phi[x];</span><br><span class="line">    &#125;</span><br><span class="line">    ll ans = x;</span><br><span class="line">    <span class="keyword">if</span> (ma.count(x)) <span class="keyword">return</span> ma[x];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; <span class="number">1l</span>l*prime[i] * prime[i] &lt;= x; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (x % prime[i] == <span class="number">0</span>) &#123;</span><br><span class="line">            ans = ans / prime[i] * (prime[i] - <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">while</span> (x % prime[i] == <span class="number">0</span>) &#123;</span><br><span class="line">                x /= prime[i];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        if (x % i == 0) &#123;</span></span><br><span class="line"><span class="comment">            ans = ans / i * (i - 1);</span></span><br><span class="line"><span class="comment">            while (x % i == 0)</span></span><br><span class="line"><span class="comment">                x /= i;</span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">1</span>) ans = ans / x * (x - <span class="number">1</span>); <span class="comment">//*****</span></span><br><span class="line">    ma[x] = ans;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">solve</span><span class="params">(<span class="keyword">int</span> ceng, ll mod)</span> </span>&#123; <span class="comment">//每层的幂是w[i]</span></span><br><span class="line">    <span class="keyword">if</span> (ceng == r || mod == <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> MOD(w[ceng], mod);</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">        qpow(w[ceng], solve(ceng + <span class="number">1</span>, getphi(mod)), mod);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    init();</span><br><span class="line">    <span class="comment">//cin &gt;&gt; n &gt;&gt; m;</span></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d %lld"</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;w[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> q;</span><br><span class="line">    <span class="comment">//cin &gt;&gt; q;</span></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;q);</span><br><span class="line">    <span class="keyword">while</span> (q--) &#123;</span><br><span class="line">        <span class="comment">//cin &gt;&gt; l &gt;&gt; r;</span></span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld %lld"</span>, &amp;l, &amp;r);</span><br><span class="line">        <span class="comment">//r = rr;</span></span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; solve(l, m) % m &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="十五-高斯消元"><a href="#十五-高斯消元" class="headerlink" title="十五, 高斯消元"></a>十五, 高斯消元</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> EPS = <span class="number">1E-9</span>;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="function"><span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">double</span>&gt; &gt; <span class="title">a</span><span class="params">(n, <span class="built_in">vector</span>&lt;<span class="keyword">double</span>&gt;(n))</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">double</span> det = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">  <span class="keyword">int</span> k = i;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt; n; ++j)</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">abs</span>(a[j][i]) &gt; <span class="built_in">abs</span>(a[k][i])) k = j;</span><br><span class="line">  <span class="keyword">if</span> (<span class="built_in">abs</span>(a[k][i]) &lt; EPS) &#123;</span><br><span class="line">    det = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  swap(a[i], a[k]);</span><br><span class="line">  <span class="keyword">if</span> (i != k) det = -det;</span><br><span class="line">  det *= a[i][i];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt; n; ++j) a[i][j] /= a[i][i];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; ++j)</span><br><span class="line">    <span class="keyword">if</span> (j != i &amp;&amp; <span class="built_in">abs</span>(a[j][i]) &gt; EPS)</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">int</span> k = i + <span class="number">1</span>; k &lt; n; ++k) a[j][k] -= a[i][k] * a[j][i];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; det;</span><br></pre></td></tr></table></figure>

<h2 id="十六-杜教BM"><a href="#十六-杜教BM" class="headerlink" title="十六, 杜教BM"></a>十六, 杜教BM</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; VI;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">10005</span>;</span><br><span class="line"><span class="keyword">const</span> ll mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-9</span>;</span><br><span class="line"><span class="function">ll <span class="title">fast_mod</span><span class="params">(ll a, ll n, ll Mod)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll ans = <span class="number">1</span>;</span><br><span class="line">    a %= Mod;</span><br><span class="line">    <span class="keyword">while</span> (n)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (n &amp; <span class="number">1</span>)</span><br><span class="line">            ans = (ans * a) % Mod;</span><br><span class="line">        a = (a * a) % Mod;</span><br><span class="line">        n&gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> linear_seq</span><br><span class="line">&#123;</span><br><span class="line">ll res[maxn], base[maxn], num[maxn], md[maxn]; <span class="comment">// 数组大小约 10000</span></span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; vec;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">mul</span><span class="params">(ll *a, ll *b, <span class="keyword">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;<span class="number">2</span> * k; i++)</span><br><span class="line">        num[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; k; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (a[i])</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; k; j++)</span><br><span class="line">                num[i + j] = (num[i + j] + a[i] * b[j]) % mod;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span> * k - <span class="number">1</span>; i&gt;= k; i--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (num[i])</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;vec.<span class="built_in">size</span>(); j++)</span><br><span class="line">                num[i - k + vec[j]] = (num[i - k + vec[j]] - num[i] * md[vec[j]]) % mod;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; k; i++)</span><br><span class="line">        a[i] = num[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">solve</span><span class="params">(ll n, VI a, VI b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll ans = <span class="number">0</span>, cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> k = a.<span class="built_in">size</span>();</span><br><span class="line">    assert(a.<span class="built_in">size</span>() == b.<span class="built_in">size</span>());</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; k; i++)</span><br><span class="line">        md[k - <span class="number">1</span> - i] = -a[i];</span><br><span class="line">    md[k] = <span class="number">1</span>;</span><br><span class="line">    vec.<span class="built_in">clear</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; k; i++)</span><br><span class="line">        <span class="keyword">if</span> (md[i])</span><br><span class="line">            vec.push_back(i);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; k; i++)</span><br><span class="line">        res[i] = base[i] = <span class="number">0</span>;</span><br><span class="line">    res[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> ((<span class="number">1L</span>L &lt;&lt; cnt) &lt;= n)</span><br><span class="line">        cnt++;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> p = cnt; p&gt;= <span class="number">0</span>; p--)</span><br><span class="line">    &#123;</span><br><span class="line">        mul(res, res, k);</span><br><span class="line">        <span class="keyword">if</span> ((n&gt;&gt; p) &amp; <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = k - <span class="number">1</span>; i&gt;= <span class="number">0</span>; i--)</span><br><span class="line">                res[i + <span class="number">1</span>] = res[i];</span><br><span class="line">            res[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; vec.<span class="built_in">size</span>(); j++)</span><br><span class="line">                res[vec[j]] = (res[vec[j]] - res[k] * md[vec[j]]) % mod;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; k; i++)</span><br><span class="line">        ans = (ans + res[i] * b[i]) % mod;</span><br><span class="line">    <span class="keyword">if</span> (ans &lt; <span class="number">0</span>)</span><br><span class="line">        ans += mod;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">VI <span class="title">BM</span><span class="params">(VI s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    VI B(1, 1), C(1, 1);</span><br><span class="line">    <span class="keyword">int</span> L = <span class="number">0</span>, m = <span class="number">1</span>, b = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; s.<span class="built_in">size</span>(); i++)</span><br><span class="line">    &#123;</span><br><span class="line">        ll d = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; L + <span class="number">1</span>; j++)</span><br><span class="line">            d = (d + (ll)C[j] * s[i - j]) % mod;</span><br><span class="line">        <span class="keyword">if</span> (d == <span class="number">0</span>)</span><br><span class="line">            m++;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (<span class="number">2</span> * L &lt;= i)</span><br><span class="line">        &#123;</span><br><span class="line">            VI T = C;</span><br><span class="line">            ll c = mod - d * fast_mod(b, mod - <span class="number">2</span>, mod) % mod;</span><br><span class="line">            <span class="keyword">while</span> (C.<span class="built_in">size</span>() &lt; B.<span class="built_in">size</span>() + m)</span><br><span class="line">                C.push_back(<span class="number">0</span>);</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; B.<span class="built_in">size</span>(); j++)</span><br><span class="line">                C[j + m] = (C[j + m] + c * B[j]) % mod;</span><br><span class="line">            L = i + <span class="number">1</span> - L, B = T, b = d, m = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            ll c = mod - d * fast_mod(b, mod - <span class="number">2</span>, mod) % mod;</span><br><span class="line">            <span class="keyword">while</span> (C.<span class="built_in">size</span>() &lt; B.<span class="built_in">size</span>() + m)</span><br><span class="line">                C.push_back(<span class="number">0</span>);</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; B.<span class="built_in">size</span>(); j++)</span><br><span class="line">                C[j + m] = (C[j + m] + c * B[j]) % mod;</span><br><span class="line">            m++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> C;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gao</span><span class="params">(VI a, ll n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    VI c = BM(a);</span><br><span class="line">    c.erase(c.<span class="built_in">begin</span>());</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; c.<span class="built_in">size</span>(); i++)</span><br><span class="line">        c[i] = (mod - c[i]) % mod;</span><br><span class="line">    <span class="keyword">return</span> solve(n, c, VI(a.<span class="built_in">begin</span>(), a.<span class="built_in">begin</span>() + c.<span class="built_in">size</span>()));</span><br><span class="line">&#125;</span><br><span class="line">&#125; <span class="comment">// namespace linear_seq</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//freopen("in.txt", "r", stdin);</span></span><br><span class="line">    <span class="comment">// 填数字的时候带上模数之后的</span></span><br><span class="line">    ll t, n;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;t);</span><br><span class="line">    <span class="keyword">while</span> (t--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;n);</span><br><span class="line">        <span class="comment">// 在 vi 中填入自己推的数 8 个以上 越多越好</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, linear_seq::gao(VI&#123;<span class="number">3</span>, <span class="number">9</span>, <span class="number">20</span>, <span class="number">46</span>, <span class="number">106</span>, <span class="number">244</span>, <span class="number">560</span>, <span class="number">1286</span>, <span class="number">2956</span>, <span class="number">6794</span>&#125;, n<span class="number">-1</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="十七-拉格朗日插值"><a href="#十七-拉格朗日插值" class="headerlink" title="十七, 拉格朗日插值"></a>十七, 拉格朗日插值</h2><p>高数的应用: 根据导数, 控制函数大小<br>这里的应用: 给出n个点P(xi, yi)，将过这个点的最多n - 1次的多项式记为f(x)，求f(k)的值</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">2010</span>;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line">ll mod = <span class="number">998244353</span>;</span><br><span class="line">ll n, k, x[maxn], y[maxn], ans, s1, s2;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">powmod</span><span class="params">(ll x, ll n)</span> </span>&#123;</span><br><span class="line">  ll ret = <span class="number">1l</span>l;</span><br><span class="line">  <span class="keyword">while</span> (n) &#123;</span><br><span class="line">    <span class="keyword">if</span> (n &amp; <span class="number">1</span>) ret = ret * x % mod;</span><br><span class="line">    x = x * x % mod;</span><br><span class="line">    n &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">inv</span><span class="params">(ll x)</span> </span>&#123; <span class="keyword">return</span> powmod(x, mod - <span class="number">2</span>); &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">"%lld%lld"</span>, &amp;n, &amp;k);</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%lld%lld"</span>, x[i], y[i]);</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">    s1 = y[i] % mod;</span><br><span class="line">    s2 = <span class="number">1l</span>l;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j++)</span><br><span class="line">      <span class="keyword">if</span> (i != j) s1 = s1 * (k - x[j]) % mod, s2 = s2 * (x[i] - x[j]) % mod;</span><br><span class="line">    ans += s1 * inv(s2) % mod;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, (ans % mod + mod) % mod);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="十八-Catalan-数列"><a href="#十八-Catalan-数列" class="headerlink" title="十八, Catalan 数列"></a>十八, Catalan 数列</h2><p>常常用来求解这样一类问题:</p>
<ol>
<li>有2n个人排成一行进入剧场。入场费5元。其中只有n个人有一张5元钞票，另外n人只有10元钞票，剧院无其它钞票，问有多少中方法使得只要有 10 元的人买票，售票处就有 5 元的钞票找零?</li>
<li>在圆上选择2n个点，将这些点成对连接起来使得所得到的n条线段不相交的方法数？</li>
<li>n个不同的数依次进栈，求不同的出栈结果的种数?</li>
</ol>
<p>这一类, 有两种选择, 每种选择只能选择有限次数, 并且两种选择的可选择次数相同, 问多少种方案的问题.</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> f[<span class="number">25</span>];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  f[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">  <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) f[i] = f[i - <span class="number">1</span>] * (<span class="number">4</span> * i - <span class="number">2</span>) / (i + <span class="number">1</span>);</span><br><span class="line">  <span class="comment">// 这里用的是常见公式2</span></span><br><span class="line">  <span class="built_in">cout</span> &lt;&lt; f[n] &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="十九-常见的期望和方差"><a href="#十九-常见的期望和方差" class="headerlink" title="十九, 常见的期望和方差"></a>十九, 常见的期望和方差</h2><h4 id="0-1分布"><a href="#0-1分布" class="headerlink" title="0-1分布"></a>0-1分布</h4><p> 1 次实验<br>P{x = 0} = p<br>P{x = 1} = 1 - p</p>
<p>E(x) = p;<br>D(x) = pq;</p>
<h4 id="二项分布-B-n-p"><a href="#二项分布-B-n-p" class="headerlink" title="二项分布 B(n, p)"></a>二项分布 B(n, p)</h4><p>n次独立重复实验<br>P{x = k} = p    </p>
<p>E(x) = np;<br>D(x) = npq;</p>
<h4 id="几何分布"><a href="#几何分布" class="headerlink" title="几何分布"></a>几何分布</h4><p>在n次独立重复实验中, 前k-1次皆失败，第k次成功的概率<br>P{x = k} = p  </p>
<p>E(x) = 1/p;<br>D(x) = (1 - p) / (p * p);</p>

        </div>

        
            <section class="post-copyright">
                
                    <p class="copyright-item">
                        <span>Author:</span>
                        <span>Qin Peng</span>
                    </p>
                
                
                
                    <p class="copyright-item">
                        <span>License:</span>
                        <span>Copyright (c) 2020 BY QPWLKQ LICENSE</span>
                    </p>
                
                
                     <p class="copyright-item">
                         <span>Slogan:</span>
                         <span>每一个不曾起舞的日子, 都是对生命的辜负</span>
                     </p>
                

            </section>
        
        <section class="post-tags">
            <div>
                <span>Tag(s):</span>
                <span class="tag">
                    
                    
                        <a href="/tags/%E6%A8%A1%E6%9D%BF/"># 模板</a>
                    
                        
                </span>
            </div>
            <div>
                <a href="javascript:window.history.back();">back</a>
                <span>· </span>
                <a href="/">home</a>
            </div>
        </section>
        <section class="post-nav">
            
                <a class="prev" rel="prev" href="/2020/10/13/%E6%A8%A1%E6%9D%BF2-%E5%AD%97%E7%AC%A6%E4%B8%B2/">模板2_字符串</a>
            
            
            <a class="next" rel="next" href="/2020/10/13/SQL%E6%9F%A5%E8%AF%A2%E8%BF%9B%E9%98%B630%E9%A2%98-%E6%96%AF%E5%9D%A6%E7%A6%8F%E5%A4%A7%E5%AD%A6%E6%95%B0%E6%8D%AE%E5%BA%93%E7%BB%83%E4%B9%A0%E9%A2%98/">SQL查询进阶30题(斯坦福大学数据库练习题)</a>
            
        </section>


    </article>
</div>

        </div>
        <footer id="footer" class="footer">
    <div class="copyright">
        <span>© Qin Peng | Powered by <a href="https://hexo.io" target="_blank">Hexo</a> & <a href="https://github.com/Siricee/hexo-theme-Chic" target="_blank">Chic</a></span>
    </div>
</footer>

    </div>
</body>
</html>
